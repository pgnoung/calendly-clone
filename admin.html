<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ | Just in time meeting</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <div class="dashboard">
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="sidebar-logo">üìÖ Just in time</div>

      <nav>
        <ul class="sidebar-nav">
          <li>
            <a href="dashboard.html">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="3" width="7" height="7"/>
                <rect x="14" y="3" width="7" height="7"/>
                <rect x="14" y="14" width="7" height="7"/>
                <rect x="3" y="14" width="7" height="7"/>
              </svg>
              <span>Dashboard</span>
            </a>
          </li>
          <li>
            <a href="admin.html" class="active">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="3"/>
                <path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z"/>
              </svg>
              <span>‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</span>
            </a>
          </li>
        </ul>
      </nav>
    </aside>

    <!-- Main Content -->
    <main class="dashboard-main">
      <div class="dashboard-header">
        <h1 class="dashboard-title">‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö</h1>
      </div>

      <!-- Tabs -->
      <div class="admin-tabs">
        <button class="admin-tab active" data-tab="event-types">üìÖ ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢</button>
        <button class="admin-tab" data-tab="team">üë• ‡∏ó‡∏µ‡∏°‡∏á‡∏≤‡∏ô</button>
        <button class="admin-tab" data-tab="availability">‚è∞ ‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</button>
      </div>

      <!-- Event Types Panel -->
      <div class="admin-panel active" id="panel-event-types">
        <div class="d-flex justify-between align-center mb-lg">
          <h2>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢</h2>
          <button class="btn btn-primary" onclick="openEventTypeModal()">
            + ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢
          </button>
        </div>

        <div class="event-type-list" id="event-types-list">
          <!-- Event Type Card -->
          <div class="event-type-card" style="border-top-color: #0069ff;">
            <h3 class="event-type-name">‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</h3>
            <p class="event-type-duration">‚è±Ô∏è 30 ‡∏ô‡∏≤‡∏ó‡∏µ ‚Ä¢ üìπ Google Meet</p>
            <div class="event-type-link">
              <span style="flex: 1; overflow: hidden; text-overflow: ellipsis;">book.html?event=meeting-30</span>
              <button class="btn btn-sm btn-secondary">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å</button>
            </div>
            <div class="event-type-actions">
              <label class="form-checkbox">
                <input type="checkbox" checked>
                <span>‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</span>
              </label>
              <div class="d-flex gap-sm">
                <button class="btn btn-sm btn-secondary">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
                <button class="btn btn-sm btn-danger">‡∏•‡∏ö</button>
              </div>
            </div>
          </div>

          <div class="event-type-card" style="border-top-color: #10b981;">
            <h3 class="event-type-name">‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡πÄ‡∏ä‡∏¥‡∏á‡∏•‡∏∂‡∏Å</h3>
            <p class="event-type-duration">‚è±Ô∏è 60 ‡∏ô‡∏≤‡∏ó‡∏µ ‚Ä¢ üìπ Google Meet</p>
            <div class="event-type-link">
              <span style="flex: 1; overflow: hidden; text-overflow: ellipsis;">book.html?event=meeting-60</span>
              <button class="btn btn-sm btn-secondary">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å</button>
            </div>
            <div class="event-type-actions">
              <label class="form-checkbox">
                <input type="checkbox" checked>
                <span>‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</span>
              </label>
              <div class="d-flex gap-sm">
                <button class="btn btn-sm btn-secondary">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
                <button class="btn btn-sm btn-danger">‡∏•‡∏ö</button>
              </div>
            </div>
          </div>

          <div class="event-type-card" style="border-top-color: #f59e0b;">
            <h3 class="event-type-name">‡πÉ‡∏´‡πâ‡∏Ñ‡∏≥‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤</h3>
            <p class="event-type-duration">‚è±Ô∏è 45 ‡∏ô‡∏≤‡∏ó‡∏µ ‚Ä¢ üìû ‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</p>
            <div class="event-type-link">
              <span style="flex: 1; overflow: hidden; text-overflow: ellipsis;">book.html?event=consultation</span>
              <button class="btn btn-sm btn-secondary">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å</button>
            </div>
            <div class="event-type-actions">
              <label class="form-checkbox">
                <input type="checkbox" checked>
                <span>‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</span>
              </label>
              <div class="d-flex gap-sm">
                <button class="btn btn-sm btn-secondary">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
                <button class="btn btn-sm btn-danger">‡∏•‡∏ö</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Team Panel -->
      <div class="admin-panel" id="panel-team">
        <div class="d-flex justify-between align-center mb-lg">
          <h2>‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏µ‡∏°</h2>
          <button class="btn btn-primary" onclick="openMemberModal()">
            + ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å
          </button>
        </div>

        <div class="member-list">
          <div class="member-card">
            <div class="member-info">
              <div class="member-avatar">‡∏™</div>
              <div>
                <div class="member-name">‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡πÉ‡∏à‡∏î‡∏µ</div>
                <div class="member-email">somchai@company.com</div>
              </div>
            </div>
            <span class="member-role admin">Admin</span>
            <div class="member-actions">
              <button class="btn btn-sm btn-secondary">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
              <button class="btn btn-sm btn-danger">‡∏•‡∏ö</button>
            </div>
          </div>

          <div class="member-card">
            <div class="member-info">
              <div class="member-avatar">‡∏´</div>
              <div>
                <div class="member-name">‡∏™‡∏°‡∏´‡∏ç‡∏¥‡∏á ‡∏£‡∏±‡∏Å‡∏á‡∏≤‡∏ô</div>
                <div class="member-email">somying@company.com</div>
              </div>
            </div>
            <span class="member-role">Member</span>
            <div class="member-actions">
              <button class="btn btn-sm btn-secondary">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
              <button class="btn btn-sm btn-danger">‡∏•‡∏ö</button>
            </div>
          </div>

          <div class="member-card">
            <div class="member-info">
              <div class="member-avatar">‡∏®</div>
              <div>
                <div class="member-name">‡∏™‡∏°‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå ‡∏ó‡∏≥‡∏î‡∏µ</div>
                <div class="member-email">somsak@company.com</div>
              </div>
            </div>
            <span class="member-role">Member</span>
            <div class="member-actions">
              <button class="btn btn-sm btn-secondary">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
              <button class="btn btn-sm btn-danger">‡∏•‡∏ö</button>
            </div>
          </div>
        </div>
      </div>

      <!-- Availability Panel -->
      <div class="admin-panel" id="panel-availability">
        <div class="d-flex justify-between align-center mb-lg">
          <h2>‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</h2>
          <button class="btn btn-primary" onclick="saveAvailability()">
            ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á
          </button>
        </div>

        <div class="card">
          <p class="text-muted mb-lg">‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏£‡∏±‡∏ö‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢‡πÑ‡∏î‡πâ</p>

          <div class="availability-grid">
            <div class="availability-day">
              <div class="day-toggle">
                <label class="form-checkbox">
                  <input type="checkbox" data-day="1" checked>
                  <span class="day-name">‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå</span>
                </label>
              </div>
              <div class="time-ranges">
                <div class="time-range">
                  <input type="time" class="time-input" value="09:00" data-day="1" data-type="start">
                  <span>-</span>
                  <input type="time" class="time-input" value="17:00" data-day="1" data-type="end">
                </div>
              </div>
            </div>

            <div class="availability-day">
              <div class="day-toggle">
                <label class="form-checkbox">
                  <input type="checkbox" data-day="2" checked>
                  <span class="day-name">‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£</span>
                </label>
              </div>
              <div class="time-ranges">
                <div class="time-range">
                  <input type="time" class="time-input" value="09:00" data-day="2" data-type="start">
                  <span>-</span>
                  <input type="time" class="time-input" value="17:00" data-day="2" data-type="end">
                </div>
              </div>
            </div>

            <div class="availability-day">
              <div class="day-toggle">
                <label class="form-checkbox">
                  <input type="checkbox" data-day="3" checked>
                  <span class="day-name">‡∏û‡∏∏‡∏ò</span>
                </label>
              </div>
              <div class="time-ranges">
                <div class="time-range">
                  <input type="time" class="time-input" value="09:00" data-day="3" data-type="start">
                  <span>-</span>
                  <input type="time" class="time-input" value="17:00" data-day="3" data-type="end">
                </div>
              </div>
            </div>

            <div class="availability-day">
              <div class="day-toggle">
                <label class="form-checkbox">
                  <input type="checkbox" data-day="4" checked>
                  <span class="day-name">‡∏û‡∏§‡∏´‡∏±‡∏™‡∏ö‡∏î‡∏µ</span>
                </label>
              </div>
              <div class="time-ranges">
                <div class="time-range">
                  <input type="time" class="time-input" value="09:00" data-day="4" data-type="start">
                  <span>-</span>
                  <input type="time" class="time-input" value="17:00" data-day="4" data-type="end">
                </div>
              </div>
            </div>

            <div class="availability-day">
              <div class="day-toggle">
                <label class="form-checkbox">
                  <input type="checkbox" data-day="5" checked>
                  <span class="day-name">‡∏®‡∏∏‡∏Å‡∏£‡πå</span>
                </label>
              </div>
              <div class="time-ranges">
                <div class="time-range">
                  <input type="time" class="time-input" value="09:00" data-day="5" data-type="start">
                  <span>-</span>
                  <input type="time" class="time-input" value="17:00" data-day="5" data-type="end">
                </div>
              </div>
            </div>

            <div class="availability-day" style="opacity: 0.6;">
              <div class="day-toggle">
                <label class="form-checkbox">
                  <input type="checkbox" data-day="6">
                  <span class="day-name">‡πÄ‡∏™‡∏≤‡∏£‡πå</span>
                </label>
              </div>
              <div class="time-ranges">
                <div class="time-range">
                  <input type="time" class="time-input" value="09:00" data-day="6" data-type="start" disabled>
                  <span>-</span>
                  <input type="time" class="time-input" value="12:00" data-day="6" data-type="end" disabled>
                </div>
              </div>
            </div>

            <div class="availability-day" style="opacity: 0.6;">
              <div class="day-toggle">
                <label class="form-checkbox">
                  <input type="checkbox" data-day="0">
                  <span class="day-name">‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå</span>
                </label>
              </div>
              <div class="time-ranges">
                <div class="time-range">
                  <input type="time" class="time-input" value="09:00" data-day="0" data-type="start" disabled>
                  <span>-</span>
                  <input type="time" class="time-input" value="12:00" data-day="0" data-type="end" disabled>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>

  <!-- Event Type Modal -->
  <div class="modal-overlay" id="event-type-modal">
    <div class="modal">
      <div class="modal-header">
        <h3 class="modal-title">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢</h3>
        <button class="modal-close" onclick="closeModal('event-type-modal')">&times;</button>
      </div>
      <div class="modal-body">
        <form id="event-type-form">
          <div class="form-group">
            <label class="form-label">‡∏ä‡∏∑‡πà‡∏≠</label>
            <input type="text" class="form-input" name="name" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ" required>
          </div>
          <div class="form-group">
            <label class="form-label">‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤ (‡∏ô‡∏≤‡∏ó‡∏µ)</label>
            <select class="form-select" name="duration">
              <option value="15">15 ‡∏ô‡∏≤‡∏ó‡∏µ</option>
              <option value="30" selected>30 ‡∏ô‡∏≤‡∏ó‡∏µ</option>
              <option value="45">45 ‡∏ô‡∏≤‡∏ó‡∏µ</option>
              <option value="60">60 ‡∏ô‡∏≤‡∏ó‡∏µ</option>
              <option value="90">90 ‡∏ô‡∏≤‡∏ó‡∏µ</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label">‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</label>
            <select class="form-select" name="location_type" id="location-type-select" onchange="toggleMeetingLinkField()">
              <option value="google_meet">üìπ Google Meet (‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥)</option>
              <option value="zoom">üíª Zoom</option>
              <option value="phone">üìû ‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</option>
              <option value="in_person">üìç ‡∏û‡∏ö‡∏´‡∏ô‡πâ‡∏≤</option>
            </select>
          </div>
          <div class="form-group" id="meeting-link-group" style="display: none;">
            <label class="form-label">‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</label>
            <input type="url" class="form-input" name="meeting_link" id="meeting-link-input" placeholder="https://zoom.us/j/xxxxxxxxx ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå">
            <small class="text-muted" id="meeting-link-hint">‡∏Å‡∏£‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå Zoom Meeting ‡∏´‡∏£‡∏∑‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà</small>
          </div>
          <div class="form-group">
            <label class="form-label">‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢</label>
            <textarea class="form-textarea" name="description" placeholder="‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°"></textarea>
          </div>
          <div class="form-group">
            <label class="form-label">‡∏™‡∏µ</label>
            <input type="color" name="color" value="#0069ff" style="width: 60px; height: 40px;">
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeModal('event-type-modal')">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
        <button class="btn btn-primary" onclick="saveEventType()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
      </div>
    </div>
  </div>

  <!-- Member Modal -->
  <div class="modal-overlay" id="member-modal">
    <div class="modal">
      <div class="modal-header">
        <h3 class="modal-title">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏µ‡∏°</h3>
        <button class="modal-close" onclick="closeModal('member-modal')">&times;</button>
      </div>
      <div class="modal-body">
        <form id="member-form">
          <div class="form-group">
            <label class="form-label">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
            <input type="text" class="form-input" name="name" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å" required>
          </div>
          <div class="form-group">
            <label class="form-label">‡∏≠‡∏µ‡πÄ‡∏°‡∏•</label>
            <input type="email" class="form-input" name="email" placeholder="email@company.com" required>
          </div>
          <div class="form-group">
            <label class="form-label">Google Calendar ID</label>
            <input type="text" class="form-input" name="calendar_id" placeholder="primary ‡∏´‡∏£‡∏∑‡∏≠ calendar ID">
            <small class="text-muted">‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏Å‡∏±‡∏ö Google Calendar</small>
          </div>
          <div class="form-group">
            <label class="form-label">‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó</label>
            <select class="form-select" name="role">
              <option value="member">Member - ‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</option>
              <option value="admin">Admin - ‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö</option>
            </select>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeModal('member-modal')">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
        <button class="btn btn-primary" onclick="saveMember()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="js/config.js"></script>
  <script src="js/api.js"></script>
  <script>
    // Tab switching
    document.querySelectorAll('.admin-tab').forEach(tab => {
      tab.addEventListener('click', () => {
        document.querySelectorAll('.admin-tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.admin-panel').forEach(p => p.classList.remove('active'));

        tab.classList.add('active');
        document.getElementById(`panel-${tab.dataset.tab}`).classList.add('active');
      });
    });

    // Handle URL hash for direct tab navigation
    if (window.location.hash) {
      const tab = document.querySelector(`[data-tab="${window.location.hash.slice(1)}"]`);
      if (tab) tab.click();
    }

    // Modal functions
    function openEventTypeModal() {
      document.getElementById('event-type-modal').classList.add('active');
    }

    function openMemberModal() {
      document.getElementById('member-modal').classList.add('active');
    }

    function closeModal(id) {
      document.getElementById(id).classList.remove('active');
    }

    // ‡πÅ‡∏™‡∏î‡∏á/‡∏ã‡πà‡∏≠‡∏ô Meeting Link ‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°
    function toggleMeetingLinkField() {
      const locationType = document.getElementById('location-type-select').value;
      const meetingLinkGroup = document.getElementById('meeting-link-group');
      const meetingLinkHint = document.getElementById('meeting-link-hint');

      if (locationType === 'google_meet') {
        meetingLinkGroup.style.display = 'none';
      } else {
        meetingLinkGroup.style.display = 'block';

        // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô hint ‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó
        if (locationType === 'zoom') {
          meetingLinkHint.textContent = '‡∏Å‡∏£‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå Zoom Meeting ‡πÄ‡∏ä‡πà‡∏ô https://zoom.us/j/123456789';
        } else if (locationType === 'phone') {
          meetingLinkHint.textContent = '‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠';
        } else if (locationType === 'in_person') {
          meetingLinkHint.textContent = '‡∏Å‡∏£‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏£‡∏∑‡∏≠‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏±‡∏î‡∏û‡∏ö';
        }
      }
    }

    function saveEventType() {
      const form = document.getElementById('event-type-form');
      const formData = new FormData(form);
      const data = Object.fromEntries(formData);

      // ‡∏™‡∏£‡πâ‡∏≤‡∏á ID ‡∏à‡∏≤‡∏Å‡∏ä‡∏∑‡πà‡∏≠
      data.id = 'custom-' + Date.now();
      data.duration = parseInt(data.duration);

      // ‡πÇ‡∏´‡∏•‡∏î event types ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà ‡πÅ‡∏•‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏±‡∏ô‡πÉ‡∏´‡∏°‡πà
      const eventTypes = getEventTypes();
      eventTypes.push(data);

      // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á localStorage
      if (saveEventTypes(eventTypes)) {
        console.log('Saved event type:', data);
        alert('‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!');
        renderEventTypesList(); // ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
      } else {
        alert('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å');
      }

      closeModal('event-type-modal');
      form.reset();
      toggleMeetingLinkField(); // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï meeting link field
    }

    function saveMember() {
      const form = document.getElementById('member-form');
      const formData = new FormData(form);
      const data = Object.fromEntries(formData);

      console.log('Saving member:', data);
      alert('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢! (‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏∞‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ Make)');
      closeModal('member-modal');
      form.reset();
    }

    function saveAvailability() {
      const availability = {};

      document.querySelectorAll('.availability-day').forEach(day => {
        const checkbox = day.querySelector('input[type="checkbox"]');
        const dayNum = checkbox.dataset.day;
        const isEnabled = checkbox.checked;

        if (isEnabled) {
          const startInput = day.querySelector('input[data-type="start"]');
          const endInput = day.querySelector('input[data-type="end"]');

          availability[dayNum] = {
            start: startInput.value,
            end: endInput.value
          };
        } else {
          availability[dayNum] = null;
        }
      });

      // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á localStorage ‡∏à‡∏£‡∏¥‡∏á‡πÜ
      if (saveWorkingHours(availability)) {
        console.log('Saved availability:', availability);
        alert('‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢! ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏à‡∏∞‡∏°‡∏µ‡∏ú‡∏•‡∏ó‡∏±‡∏ô‡∏ó‡∏µ');
      } else {
        alert('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà');
      }
    }

    // ‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏à‡∏≤‡∏Å localStorage ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤
    function loadAvailabilityUI() {
      const workingHours = getWorkingHours();

      document.querySelectorAll('.availability-day').forEach(day => {
        const checkbox = day.querySelector('input[type="checkbox"]');
        const dayNum = parseInt(checkbox.dataset.day);
        const hours = workingHours[dayNum];

        const startInput = day.querySelector('input[data-type="start"]');
        const endInput = day.querySelector('input[data-type="end"]');

        if (hours) {
          checkbox.checked = true;
          startInput.value = hours.start;
          endInput.value = hours.end;
          startInput.disabled = false;
          endInput.disabled = false;
          day.style.opacity = '1';
        } else {
          checkbox.checked = false;
          startInput.disabled = true;
          endInput.disabled = true;
          day.style.opacity = '0.6';
        }
      });
    }

    // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à
    document.addEventListener('DOMContentLoaded', () => {
      loadAvailabilityUI();
      renderEventTypesList();
    });

    // ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢‡∏à‡∏≤‡∏Å localStorage
    function renderEventTypesList() {
      const container = document.getElementById('event-types-list');
      const eventTypes = getEventTypes();

      container.innerHTML = eventTypes.map((event, index) => `
        <div class="event-type-card" style="border-top-color: ${event.color || '#0069ff'};">
          <h3 class="event-type-name">${event.name}</h3>
          <p class="event-type-duration">‚è±Ô∏è ${event.duration} ‡∏ô‡∏≤‡∏ó‡∏µ ‚Ä¢ ${getLocationIcon(event.location_type)} ${getLocationLabel(event.location_type)}</p>
          ${event.meeting_link ? `<p class="event-type-link-info" style="font-size: 0.85rem; color: #666; margin: 0.5rem 0;">üîó ${event.meeting_link}</p>` : ''}
          <div class="event-type-link">
            <span style="flex: 1; overflow: hidden; text-overflow: ellipsis;">book.html?event=${event.id}</span>
            <button class="btn btn-sm btn-secondary" onclick="copyEventLink('${event.id}')">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å</button>
          </div>
          <div class="event-type-actions">
            <label class="form-checkbox">
              <input type="checkbox" ${event.enabled !== false ? 'checked' : ''} onchange="toggleEventType(${index})">
              <span>‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</span>
            </label>
            <div class="d-flex gap-sm">
              <button class="btn btn-sm btn-secondary" onclick="editEventType(${index})">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
              <button class="btn btn-sm btn-danger" onclick="deleteEventType(${index})">‡∏•‡∏ö</button>
            </div>
          </div>
        </div>
      `).join('');
    }

    function getLocationIcon(type) {
      const icons = { google_meet: 'üìπ', zoom: 'üíª', phone: 'üìû', in_person: 'üìç' };
      return icons[type] || 'üìç';
    }

    function getLocationLabel(type) {
      const labels = { google_meet: 'Google Meet', zoom: 'Zoom', phone: '‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå', in_person: '‡∏û‡∏ö‡∏´‡∏ô‡πâ‡∏≤' };
      return labels[type] || type;
    }

    function copyEventLink(eventId) {
      const url = window.location.origin + '/book.html?event=' + eventId;
      navigator.clipboard.writeText(url).then(() => {
        alert('‚úÖ ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!');
      });
    }

    function toggleEventType(index) {
      const eventTypes = getEventTypes();
      eventTypes[index].enabled = !eventTypes[index].enabled;
      saveEventTypes(eventTypes);
    }

    function deleteEventType(index) {
      if (!confirm('‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢‡∏ô‡∏µ‡πâ?')) return;

      const eventTypes = getEventTypes();
      eventTypes.splice(index, 1);
      saveEventTypes(eventTypes);
      renderEventTypesList();
      alert('‚úÖ ‡∏•‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!');
    }

    let editingIndex = null;

    function editEventType(index) {
      editingIndex = index;
      const eventTypes = getEventTypes();
      const event = eventTypes[index];

      // ‡πÄ‡∏ï‡∏¥‡∏°‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô form
      const form = document.getElementById('event-type-form');
      form.name.value = event.name;
      form.duration.value = event.duration;
      form.location_type.value = event.location_type;
      form.description.value = event.description || '';
      form.color.value = event.color || '#0069ff';

      if (form.meeting_link) {
        form.meeting_link.value = event.meeting_link || '';
      }

      // ‡πÅ‡∏™‡∏î‡∏á meeting link field ‡∏ñ‡πâ‡∏≤‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô
      toggleMeetingLinkField();

      // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ä‡∏∑‡πà‡∏≠ modal
      document.querySelector('#event-type-modal .modal-title').textContent = '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢';

      openEventTypeModal();
    }

    // ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç saveEventType ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
    const originalSaveEventType = saveEventType;
    saveEventType = function() {
      const form = document.getElementById('event-type-form');
      const formData = new FormData(form);
      const data = Object.fromEntries(formData);
      data.duration = parseInt(data.duration);

      const eventTypes = getEventTypes();

      if (editingIndex !== null) {
        // ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏≠‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà
        data.id = eventTypes[editingIndex].id;
        eventTypes[editingIndex] = { ...eventTypes[editingIndex], ...data };
        editingIndex = null;
        document.querySelector('#event-type-modal .modal-title').textContent = '‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢';
      } else {
        // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏±‡∏ô‡πÉ‡∏´‡∏°‡πà
        data.id = 'custom-' + Date.now();
        eventTypes.push(data);
      }

      if (saveEventTypes(eventTypes)) {
        alert('‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!');
        renderEventTypesList();
      } else {
        alert('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å');
      }

      closeModal('event-type-modal');
      form.reset();
      toggleMeetingLinkField();
    };

    // Enable/disable time inputs based on checkbox
    document.querySelectorAll('.availability-day input[type="checkbox"]').forEach(checkbox => {
      checkbox.addEventListener('change', (e) => {
        const day = e.target.closest('.availability-day');
        const timeInputs = day.querySelectorAll('.time-input');
        timeInputs.forEach(input => {
          input.disabled = !e.target.checked;
        });
        day.style.opacity = e.target.checked ? '1' : '0.6';
      });
    });

    // Close modal on overlay click
    document.querySelectorAll('.modal-overlay').forEach(overlay => {
      overlay.addEventListener('click', (e) => {
        if (e.target === overlay) {
          overlay.classList.remove('active');
        }
      });
    });
  </script>
</body>
</html>
